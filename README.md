# kubernetes_task
Решение для веб-приложения в kubernetes

## Как я искал решение

Для решения задачи я проанализировал несколько ключевых требований:

### Мультизональный кластер с пятью нодами

- **Отказоустойчивость**: Важно, чтобы приложение было отказоустойчивым, даже если одна зона выходит из строя. Это означает, что поды должны быть равномерно распределены по зонам и не все поды должны быть запущены в одной зоне.

### Приложение требует около 5-10 секунд для инициализации

- **Задержка при запуске**: Важно учесть задержку при запуске контейнера. Для этого используется `readinessProbe`, которая задерживает передачу трафика на под до тех пор, пока приложение полностью не инициализируется.

### По результатам нагрузочного теста 4 пода справляются с пиковой нагрузкой

- **Количество реплик**: Начальное количество реплик я задал равным 4, чтобы покрыть пиковую нагрузку.

### Пиковое потребление ресурсов CPU при первых запросах

- **CPU Limits**: В начале поды должны быть готовы обрабатывать высокий уровень запросов, поэтому важно задать `cpu limits`, чтобы обеспечить необходимую производительность на старте.

### Приложение имеет дневной цикл по нагрузке

- **HorizontalPodAutoscaler (HPA)**: Для эффективного использования ресурсов я добавил HPA, который будет масштабировать количество подов в зависимости от загрузки CPU. Ночью HPA уменьшит количество подов, что минимизирует потребление ресурсов.

### Максимально отказоустойчивый deployment и минимальное потребление ресурсов

- **Pod Anti-Affinity**: Я использовал под-антиаффинити (pod anti-affinity), чтобы поды одного приложения не запускались на одной и той же ноде, что повышает отказоустойчивость.
- **Resource Requests и Limits**: Параметры `requests` и `limits` для ресурсов настроены так, чтобы минимизировать потребление ресурсов при стабильной работе приложения.

## Вывод

Результирующее решение включает в себя манифесты Deployment и HPA, которые:

- Обеспечивают отказоустойчивость за счет равномерного распределения подов по зонам и узлам.
- Учитывают начальное высокое потребление ресурсов при запуске.
- Используют HPA для адаптации к изменяющейся дневной и ночной нагрузке, что минимизирует использование ресурсов в не пиковые периоды.

Такой подход позволяет эффективно использовать ресурсы кластера и поддерживать высокую доступность приложения.
